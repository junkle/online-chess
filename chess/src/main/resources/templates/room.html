<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org" xmlns:pd="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>象棋盘</title>
    <link th:href="@{/css/bootstrap.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/chess.css}" rel="stylesheet" type="text/css"/>
    <style>
        .rect {
            height: 100px;
            border: 1px solid black;
            padding: 40px 0;
            border-top-right-radius: 5px;
            border-top-left-radius: 5px;
            border-bottom-right-radius: 5px;
            border-bottom-left-radius: 5px;
            margin-top: 10px;
            margin-left: 10px;
        }

        body {
            background: url("../../img/background/room.jpg") center no-repeat fixed;
            background-size: 100% 100%;
            height: 100%;
            width: 100%;
        }
    </style>
</head>

<body class="container">

<button class="btn btn-primary" id="createRoom"  data-toggle="modal" data-target="#myModal">创建房间</button>

<div class="row" id="roomConfig">
    <h1 th:if="${roomSize == 0}" class="text-center" style="color: whitesmoke">暂无房间</h1>
    <div class="col-lg-2 rect center-block text-center" th:each="room,status : ${rooms} ">
            <a th:href="@{'javascript:enterRoom(' + ${room.roomId} + ')'}" th:text="${room.roomName}"
               class="label label-info"></a>
            <br>
            <label class="label label-success" th:if="${room.getPeopleNum().get() == 1}">房间人数：1人</label>
            <label class="label label-warning" th:if="${room.getPeopleNum().get() >= 2}">房间已满</label>
    </div>


</div>
<div th:include="template :: #chess" style="display: none" id="loadGame"></div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">房间名称</h4>
            </div>
            <div class="modal-body">
                <input class="input-lg" id="roomInput">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" id="confirm" data-dismiss="modal">确认</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
</body>
<script th:src="@{/js/jquery-3.1.1.min.js}" type="text/javascript"></script>
<script th:src="@{/js/jquery.beattext.js}" type="text/javascript"></script>
<script th:src="@{/js/easying.js}" type="text/javascript"></script>
<script th:src="@{/js/bootstrap.js}" type="text/javascript"></script>
<script th:src="@{/js/util.js}" type="text/javascript"></script>
<script th:src="@{/js/socket.js}" type="text/javascript"></script>
<script th:src="@{/js/chessGame.js}" type="text/javascript"></script>
<script th:src="@{/js/operator.js}" type="text/javascript"></script>
<script>
    $(function () {
        $('#confirm').on('click', function () {
            var val = $('#roomInput').val();
            if (val == null || val == "") {
                val = Math.random() * 10000;
            }
            var msg = new socketMessage("createRoom", val);
            sendMsg(msg);
        });
    });

    function enterRoom(id) {
        var msg = new socketMessage("enterRoom", id);
        sendMsg(msg)
    }

    function loadGame() {
        $('#loadGame').css("display", "");
        $('#roomConfig').css("display", "none");
    }

    function sendMsg(msg) {
        webSocket.send(JSON.stringify(msg));
    }
</script>

</html>